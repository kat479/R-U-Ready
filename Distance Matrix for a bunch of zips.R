
#Distance Matrix for a bunch of zips

library(ggmap)

dist <- data.frame()

zip <- c('12866',  '12912',	'12834',	'12901',	'12814',	'12953',	'12804',	'12932',	'12208',	'12801',	'12020',	'12842',	'12090',	'12883',	'12946',	'12180',	'12828',	'12074',	'12944',	'12822',	'12993',	'12206',	'12817',	'12205',	'12019',	'12847',	'12839',	'12885',	'12983',	'12972',	'12986',	'12211',	'12928',	'12831',	'12871',	'12832',	'12957',	'12118',	'12865',	'12833',	'12170',	'12919',	'14301',	'14228',	'14094',	'14226',	'14221',	'14223',	'14304',	'14303',	'14120',	'14108',	'14092',	'14217',	'14203',	'14305',	'14043',	'14072',	'14172',	'94526',	'94588',	'94583',	'94301',	'95630',	'95642',	'95821',	'95608',	'95665',	'94545',	'94538',	'94550',	'95628',	'95661',	'94546',	'95670',	'95825',	'95667',	'95682',	'95831',	'95640',	'94598',	'94566',	'94507',	'95709',	'95762',	'95666',	'94541',	'94506',	'94536',	'94606',	'94501',	'94609',	'94806',	'94523',	'94520',	'94706',	'94596',	'94564',	'94563',	'94612',	'12887',	'94619',	'94605',	'94517',	'94608',	'94607',	'94705',	'94521',	'94704',	'94703',	'94601',	'12937',	'12933',	'12816',	'12853',	'12980',	'12027',	'94118',	'94109',	'94117',	'94108',	'94115',	'94114',	'94133',	'94111',	'94143',	'94925',	'94102',	'94121',	'95521',	'95688',	'95603',	'95573',	'95501',	'95602',	'95476',	'94589',	'94533',	'94534',	'95687',	'95616',	'95620',	'94558',	'95691',	'94559',	'94590',	'94574',	'95945',	'94510',	'95959',	'95491',	'95776',	'95695',	'95949',	'94503',	'94591',	'95650',	'95531',	'95503',	'95519',	'95542',	'95540',	'92114',	'94015',	'93940',	'96093',	'95560',	'95536')

for (k in 1:length(zip))
{
 assign(paste('p',k,sep = ''),geocode(zip[k],override_limit = TRUE))
}

geodetic.distance <- function(point1, point2)
{
  R <- 6997
  p1rad <- point1 * pi/180
  p2rad <- point2 * pi/180
  d <- sin(p1rad[2])*sin(p2rad[2])+cos(p1rad[2])*cos(p2rad[2])*cos(abs(p1rad[1]-p2rad[1]))  
  d <- acos(d)
  R*d
}

for (i in 1:168)
{
  for(j in 1:168)
  {
   dist[i,j] = as.numeric(geodetic.distance(get(paste('p',i,sep='')),get(paste('p',j,sep=''))))
  }
}
